"use strict";(self.webpackChunkwayang_website=self.webpackChunkwayang_website||[]).push([[4078],{4659:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var t=a(4848),r=a(8453);const i={title:"Using Wayang's docker image",sidebar_position:9,id:"wayang-docker"},o="Using Wayang's docker image",s={id:"guide/wayang-docker",title:"Using Wayang's docker image",description:"\x3c!--",source:"@site/docs/guide/wayang-in-docker.md",sourceDirName:"guide",slug:"/guide/wayang-docker",permalink:"/docs/guide/wayang-docker",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"Using Wayang's docker image",sidebar_position:9,id:"wayang-docker"},sidebar:"guideSidebar",previous:{title:"Data processing optimizer",permalink:"/docs/guide/optimizer"}},c={},l=[{value:"Step 1: Creating a docker-compose file",id:"step-1-creating-a-docker-compose-file",level:2},{value:"Step 2: Connecting to the app container",id:"step-2-connecting-to-the-app-container",level:2},{value:"Step 3: Compiling Wayang and running benchmarks",id:"step-3-compiling-wayang-and-running-benchmarks",level:2},{value:"Optional: Add clusters for additional platforms to your docker setup",id:"optional-add-clusters-for-additional-platforms-to-your-docker-setup",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"using-wayangs-docker-image",children:"Using Wayang's docker image"}),"\n",(0,t.jsx)(n.p,{children:"This guide provides a brief example for developers that want to utilize\ndocker in order to develop with Wayang."}),"\n",(0,t.jsx)(n.h2,{id:"step-1-creating-a-docker-compose-file",children:"Step 1: Creating a docker-compose file"}),"\n",(0,t.jsxs)(n.p,{children:["This guide assumes knowledge about\n",(0,t.jsx)(n.a,{href:"https://docs.docker.com/engine/install/",children:"docker"})," and\n",(0,t.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"docker compose"}),".\nWe provide a ",(0,t.jsx)(n.a,{href:"https://hub.docker.com/r/apache/incubator-wayang",children:"pre-built docker image"}),"\nthat contains the necessary tooling in order to run or develop Apache Wayang.\nThe tools necessary for this are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Java 11"}),"\n",(0,t.jsx)(n.li,{children:"Apache Spark"}),"\n",(0,t.jsx)(n.li,{children:"Hadoop"}),"\n",(0,t.jsx)(n.li,{children:"Maven"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"docker-compose.yml"})," containing the following services will suffice to\nrun ",(0,t.jsx)(n.a,{href:"https://www.tpc.org/tpch/",children:"TPC-H"})," benchmarks:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yml",children:"name: apache-wayang\n\nservices:\n  app:\n    container_name: apache-wayang-app\n    image: apache/incubator-wayang:latest\n    ports:\n      - 8888:8888\n    volumes:\n      - ./:/var/www/html\n      - ./.m2/repository/:/root/.m2/repository\n    tty: true\n    restart: always\n\n  tpch:\n    container_name: apache-wayang-tpch\n    image: ghcr.io/scalytics/tpch-docker:main\n    tty: true\n    volumes:\n      - ./data/:/data\n    restart: always\n"})}),"\n",(0,t.jsx)(n.p,{children:"Placing this file in the root directory of Wayang's source will mount\nvolumes containing the application and its dependencies after\ninstallation into the app container."}),"\n",(0,t.jsx)(n.h2,{id:"step-2-connecting-to-the-app-container",children:"Step 2: Connecting to the app container"}),"\n",(0,t.jsx)(n.p,{children:"In order to get a interactive bash session that allows running commands\ninside of the app container, run the following:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker exec -it apache-wayang-app bash\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-3-compiling-wayang-and-running-benchmarks",children:"Step 3: Compiling Wayang and running benchmarks"}),"\n",(0,t.jsx)(n.p,{children:"Within the root directory of Wayang (/var/www/html in our container),\nrun the following command to install all packages in Wayang:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"mvn clean install -DskipTests\n"})}),"\n",(0,t.jsx)(n.p,{children:"Packaging the project to build the executable:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"mvn clean package -pl :wayang-assembly -Pdistribution\n"})}),"\n",(0,t.jsx)(n.p,{children:"Execute your code:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd wayang-assembly/target/\ntar -xvf apache-wayang-assembly-0.7.1-incubating-dist.tar.gz\ncd wayang-0.7.1\n./bin/wayang-submit org.apache.wayang.<main_class> <parameters>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"optional-add-clusters-for-additional-platforms-to-your-docker-setup",children:"Optional: Add clusters for additional platforms to your docker setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yml",children:"name: apache-wayang\n\nservices:\n  app:\n    container_name: apache-wayang-app\n    image: apache/incubator-wayang:latest\n    ports:\n      - 8888:8888\n    volumes:\n      - ./:/var/www/html\n      - ./.m2/repository/:/root/.m2/repository\n    tty: true\n    restart: always\n\n  tpch:\n    container_name: apache-wayang-tpch\n    image: ghcr.io/scalytics/tpch-docker:main\n    tty: true\n    volumes:\n      - ./data/:/data\n    restart: always\n\n  spark-master:\n    image: cluster-apache-spark:3.0.2\n\n  spark-worker-a:\n    image: cluster-apache-spark:3.0.2\n    depends_on:\n      - spark-master\n    environment:\n      - SPARK_MASTER=spark://spark-master:7077\n      - SPARK_WORKER_CORES=1\n      - SPARK_WORKER_MEMORY=1G\n      - SPARK_DRIVER_MEMORY=1G\n      - SPARK_EXECUTOR_MEMORY=1G\n      - SPARK_WORKLOAD=worker\n      - SPARK_LOCAL_IP=spark-worker-a\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>s});var t=a(6540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);